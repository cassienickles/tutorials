{"title":"This Notebook is no longer up to date, a newer version exists [here](https://github.com/podaac/tutorials/blob/master/notebooks/PODAAC_CMR_Shapefile_Search_MODIS_UAT.ipynb)","markdown":{"headingText":"This Notebook is no longer up to date, a newer version exists [here](https://github.com/podaac/tutorials/blob/master/notebooks/PODAAC_CMR_Shapefile_Search_MODIS_UAT.ipynb)","containsRefs":false,"markdown":"\n## Shapefile Search in the Common Metadata Repository (CMR)\n\nCMR allows the upload of ESRI Shapefiles via command line for granule and collection level search. To use this functionality from the command line, we can use curl or python to do our search. This example will run through the curl command line program and a python request for doing shapefile search.\n\nPrerequisites:\n\n* a valid ESRI Shapefile\n* (optional) Collection identifier (concept-id) for granule level search \n\nWe will use a shapefile located in the github/podaac source repository for this search: https://github.com/podaac/tutorials/blob/master/notebooks/resources/gulf_shapefile.zip\n\nFor more information on collections, granules, and concept-ids, please refer to the following tutorial:\n\nhttps://github.com/podaac/tutorials/blob/master/notebooks/podaac_cmr_tutorial.ipynb\n\nFor our tutorial, we will be using a **TEST** collection available at the cmr uat environment. This is an environment, open to the public, where new functionality is released and users can submit feedback on it before it makes its way to the operational system.\n\nThis collection is an L2 collection titled AMSR2-REMSS-L2P-v8a, from the Advanced Microwave Scanning Radiometer 2. It has the concept id:\n\n**C1225996408-POCUMULUS**\n\n\n\n## Python tutorial shapefile search\n\nThe following snippet will use the 'requests' library along with the shapefile available at github to perform a shapefile search on the CMR. It will return values that overlap or intersect the shapefile provided.\n\n## Curl command line syntax\n\nThis command submits the same request as the Python example above, returning search results in JSON format for Granules that share spatial coverage with the input shapefile ([`resources/gulf_shapefile.zip`](resources/gulf_shapefile.zip)) and belong to the target Collection (`echo_collection_id=C1225996408-POCUMULUS`):\n\n```shell\ncurl -XPOST \"https://cmr.uat.earthdata.nasa.gov/search/granules.json\" -F \"shapefile=@resources/gulf_shapefile.zip;type=application/shapefile+zip\" -F \"echo_collection_id=C1225996408-POCUMULUS\" -F \"pretty=true\"\n```\n\nThe (truncated) results:\n\n```json\n{\n  \"feed\" : {\n    \"updated\" : \"2020-05-18T22:09:58.452Z\",\n    \"id\" : \"https://cmr.uat.earthdata.nasa.gov:443/search/granules.json\",\n    \"title\" : \"ECHO granule metadata\",\n    \"entry\" : [ {\n      \"time_start\" : \"2018-01-01T05:56:16.000Z\",\n      \"granule_size\" : \"1.0242048E7\",\n      \"online_access_flag\" : true,\n      \"id\" : \"G1226019017-POCUMULUS\",\n      \"day_night_flag\" : \"UNSPECIFIED\",\n      \"browse_flag\" : false,\n      \"time_end\" : \"2018-01-01T07:34:24.000Z\",\n      \"coordinate_system\" : \"CARTESIAN\",\n      \"polygons\" : [ [ \"-74.21 -163.74 -72.95 -180 -75.43 -180 -74.21 -163.74\" ], [ \"-72.95 180 -69.22 161.56 -63.56 148.24 -59.74 142.63 -54.76 137.29 -43.19 129.21 -28.81 123 -9.39 117.38 70.28 101.89 78.71 98.84 83.8 94.5 85.75 90.5 87.14 84.43 88.59 63.9 89.12 2.26 88.28 -48.29 87.12 -61.14 85.38 -68.1 82.54 -72.63 77.71 -75.93 63.62 -80.05 9.8 -89.82 -15.54 -95.55 -35.84 -102.3 -50.51 -110.4 -56.3 -115.37 -60.99 -120.88 -64.95 -127.37 -68.22 -135.08 -70.76 -143.97 -72.76 -155.11 -74.35 -180 -89.345 -180 -88.32 -113.33 -86.69 -101.61 -83.86 -95.95 -79.32 -92.73 -70.2 -89.86 -10.6 -79.24 16.19 -73.27 33.1 -67.88 46.23 -61.6 52.76 -57.05 57.86 -52.26 62.64 -46.04 66.5 -38.81 69.5 -30.55 71.71 -21.38 74.26 1.26 73.75 29.71 72.1 42.61 69.64 53.42 66.25 62.72 62.36 69.82 57.32 76.19 51.2 81.62 37.2 89.55 18.32 96.04 -10.4 102.56 -70.39 113.28 -79.49 116.19 -83.94 119.43 -86.33 123.83 -87.89 131.86 -86.97 131.68 -85.71 133.93 -81.4 147.95 -77.84 164.04 -75.43 180 -72.95 180\" ], [ \"-74.35 180 -74.81 162.65 -77.45 142.63 -82.89 118.89 -85.78 110.18 -87.46 107.84 -88.13 109.51 -88.85 123.7 -89.345 180 -74.35 180\" ] ],\n      \"original_format\" : \"UMM_JSON\",\n      \"collection_concept_id\" : \"C1225996408-POCUMULUS\",\n      \"data_center\" : \"POCUMULUS\",\n      \"links\" : [ {\n        \"rel\" : \"http://esipfed.org/ns/fedsearch/1.1/data#\",\n        \"hreflang\" : \"en-US\",\n        \"href\" : \"s3://podaac-dev-l2ss-samples/20180101055616-REMSS-L2P_GHRSST-SSTsubskin-AMSR2-L2B_rt_r29921-v02.0-fv01.0.nc\"\n      },\n      ...\n```\n\n\nThis command gets the same listing again with `curl`, this time returning the search results in their native xml format:\n\n```shell\ncurl -XPOST \"https://cmr.uat.earthdata.nasa.gov/search/granules\" -F \"shapefile=@resources/gulf_shapefile.zip;type=application/shapefile+zip\" -F \"echo_collection_id=C1225996408-POCUMULUS\" -F \"pretty=true\"\n```\n\nThe (truncated) results:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<results>\n    <hits>1912</hits>\n    <took>970</took>\n    <references>\n        <reference>\n            <name>20180101055616-REMSS-L2P_GHRSST-SSTsubskin-AMSR2-L2B_rt_r29921-v02.0-fv01.0.nc</name>\n            <id>G1226019017-POCUMULUS</id>\n            <location>https://cmr.uat.earthdata.nasa.gov:443/search/concepts/G1226019017-POCUMULUS/1</location>\n            <revision-id>1</revision-id>\n        </reference>\n        <reference>\n            <name>20180101055616-REMSS-L2P_GHRSST-SSTsubskin-AMSR2-L2B_v08_r29921-v02.0-fv01.0.nc</name>\n            <id>G1226019025-POCUMULUS</id>\n            <location>https://cmr.uat.earthdata.nasa.gov:443/search/concepts/G1226019025-POCUMULUS/1</location>\n            <revision-id>1</revision-id>\n        </reference>\n        <reference>\n            <name>20180101073424-REMSS-L2P_GHRSST-SSTsubskin-AMSR2-L2B_rt_r29922-v02.0-fv01.0.nc</name>\n            <id>G1226019035-POCUMULUS</id>\n            <location>https://cmr.uat.earthdata.nasa.gov:443/search/concepts/G1226019035-POCUMULUS/1</location>\n            <revision-id>1</revision-id>\n        </reference>\n        ...\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["../include-files.lua","quarto"],"toc":true,"output-file":"Podaac_CMR_Shapefile_Search.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.251","theme":{"light":["cosmo","theme.scss"],"dark":["cosmo","theme-dark.scss"]},"code-copy":true},"extensions":{"book":{"multiFile":true}}}}}