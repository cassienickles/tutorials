{"title":"SWOT Simulated North American Continent Hydrology Dataset Exploration in the Cloud","markdown":{"headingText":"SWOT Simulated North American Continent Hydrology Dataset Exploration in the Cloud","containsRefs":false,"markdown":"\n\n## Accessing and Visualizing SWOT Simulated Datasets\n\n### Learning Objectives:\n- Access all 5 products of SWOT HR sample data (archived in NASA Earthdata Cloud) in the AWS cloud, without downloading to local machine\n- Visualize accessed data\n\n### SWOT Simulated Level 2 North America Continent KaRIn High Rate Version 1 Datasets:\n\n1. **River Vector Shapefile** - SWOT_SIMULATED_NA_CONTINENT_L2_HR_RIVERSP_V1\n\n>DOI: [https://doi.org/10.5067/KARIN-2RSP1](https://doi.org/10.5067/KARIN-2RSP1)\n\n2. **Lake Vector Shapefile** - SWOT_SIMULATED_NA_CONTINENT_L2_HR_LAKESP_V1\n    \n>DOI: [https://doi.org/10.5067/KARIN-2LSP1](https://doi.org/10.5067/KARIN-2LSP1) \n\n3. **Water Mask Pixel Cloud NetCDF** - SWOT_SIMULATED_NA_CONTINENT_L2_HR_PIXC_V1\n\n>DOI: [https://doi.org/10.5067/KARIN-2PIX1](https://doi.org/10.5067/KARIN-2PIX1) \n    \n4. **Water Mask Pixel Cloud Vector Attribute NetCDF** - SWOT_SIMULATED_NA_CONTINENT_L2_HR_PIXCVEC_V1\n    \n>DOI: [https://doi.org/10.5067/KARIN-2PXV1](https://doi.org/10.5067/KARIN-2PXV1) \n\n5. **Raster NetCDF** - SWOT_SIMULATED_NA_CONTINENT_L2_HR_RASTER_V1\n\n>DOI: [https://doi.org/10.5067/KARIN-2RAS1](https://doi.org/10.5067/KARIN-2RAS1) \n\n_Notebook Author: Cassie Nickles, NASA PO.DAAC (Aug 2022)_\n  \n\n### Libraries Needed\n\n## Get Temporary AWS Credentials for Access\n\nS3 is an 'object store' hosted in AWS for cloud processing. Direct S3 access is achieved by passing NASA supplied temporary credentials to AWS so we can interact with S3 objects from applicable Earthdata Cloud buckets. Note, these temporary credentials are valid for only 1 hour. A netrc file is required to aquire these credentials. Use the [NASA Earthdata Authentication](https://github.com/NASA-Openscapes/2021-Cloud-Hackathon/blob/main/tutorials/04_NASA_Earthdata_Authentication.ipynb) to create a netrc file in your home directory. (Note: A NASA Earthdata Login is required to access data from the NASA Earthdata system. Please visit https://urs.earthdata.nasa.gov to register and manage your Earthdata Login account. This account is free to create and only takes a moment to set up.) \n\nThe following crediential is for PODAAC, but other credentials are needed to access data from other NASA DAACs.\n\nCreate a function to make a request to an endpoint for temporary credentials.\n\n#### Set up an `s3fs` session for Direct Access\n`s3fs` sessions are used for authenticated access to s3 bucket and allows for typical file-system style operations. Below we create session by passing in the temporary credentials we recieved from our temporary credentials endpoint.\n\n## Single File Access\n\nThe s3 access link can be found using Earthdata Search [(see tutorial)](https://nasa-openscapes.github.io/2021-Cloud-Workshop-AGU/tutorials/01_Earthdata_Search.html) for a single file is as follows:\n\n**1. River Vector Shapefiles**\n\nThe native format for this sample data is a .zip file, and we want the .shp file within the .zip file, so we need to download the contents of the zip file into the cloud environment. I created a folder called `SWOT_HR_shp` to write to. Change the path to where you would like your extracted files to be written.\n\n\nNext, we'll look at the attribute table of the .shp file we just extracted to the 'SWOT_HR_shp' folder.\n\n**2. Lake Vector Shapefiles**\n\nThe lake vector shapefiles can be accessed in the same way as the river shapefiles above.\n\n**3. Water Mask Pixel Cloud NetCDF**\n\nAccessing the remaining files is different than the shp files above. We do not need to unzip the files because they are stored in native netCDF files in the cloud. For the rest of the products, we will open via `xarray`.\n\nThe pixel cloud netCDF files are formatted with three groups titled, \"pixel cloud\", \"tvp\", or \"noise\" (more detail [here](https://podaac-tools.jpl.nasa.gov/drive/files/misc/web/misc/swot_mission_docs/pdd/D-56411_SWOT_Product_Description_L2_HR_PIXC_20200810.pdf)). In order to access the coordinates and variables within the file, a group must be specified when calling xarray open_dataset.\n\n**4. Water Mask Pixel Cloud Vector Attribute NetCDF**\n\n**5. Raster NetCDF**\n\nIt's easy to analyze and plot the data with packages such as `hvplot`!\n\n#### [Link to GitHub Notebook Location](https://github.com/podaac/tutorials/blob/master/notebooks/meetings_workshops/swot_ea_workshop_sept2022/SWOTHR_s3Access.ipynb) from Quarto Website\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["../../../include-files.lua","quarto"],"toc":true,"output-file":"SWOTHR_s3Access.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.251","theme":{"light":"cosmo","dark":"darkly"},"code-copy":true},"extensions":{"book":{"multiFile":true}}}}}