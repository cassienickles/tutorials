{"title":"HUC Feature Translation Service (FTS) Examples","markdown":{"headingText":"HUC Feature Translation Service (FTS) Examples","containsRefs":false,"markdown":"\n\nThis Jupyter Notebook contains examples related to geospatial search using the PO.DAAC *HUC Feature Translation Service (FTS)*, previewing (viusualizing) the queried region of interest, and using FTS results to query data through NASA's Common Metadata Repository (CMR).\n\n**Example Use Case:** \nCheck if data is available over my region of interest using HUCs. In this example we are using the FTS-HUC API (https://fts.podaac.earthdata.nasa.gov/) to geospatially define our region of interest, namely the Upper Tuolumne River Basin in the San Joaquin River Basin in California's Sierra Nevada Mountains, searching by HUC or region name, and then using those geospatial bounds (coordinates) to query Sentinel-1 data in CMR.\n1. use FTS to define geographic region of interest (query by partial or exact HUC or HUC region name)\n2. preview query \n3. use coordinates returned by FTS to query Sentinel-1 data in CMR, by polygon or bounding box.\n\n**Resources**\n\nUSGS Hydrologic unit map to help identifiy region of interest (e.g. HUC value or name) can be found here: https://water.usgs.gov/GIS/regions.html \n\n## Install libraries\n\n## Search Feature Translation Service for Partial Region Matches\n\nIf you are unsure what the corresponding HUC is for your region of interest, you can query the FTS for _partial_ region matches, by setting `EXACT = FALSE`.\n\n## Search Feature Translation Service for Exact HUC Matches\n\nHere we can set a HUC ID, or hydrologic unit code, and use this to query the HUC FTS. By defining the parameter _EXACT = True_, we tell the query to not search for partial matches.\n\nBased on the partial name response in the previous step, we can now do an exact search for San Joaquin River Basin, using its HUC ID (1804).\n\n## Search Feature Translation Service for Partial Region Matches\n\nBut in this case we are specifically interested in Tuolumne River Basin _within_ the San Joaquin main basin, so let's do a partial search for \"Upper Tuo\", given we may not know the exact region name.\n\n## Search Feature Translation Service for Exact HUC and Named Region Matches\n\nGiven the above response, or that we already know an exact region name or HUC in USGS's Watershed Boundary Dataset (WBD), we can use this instead of a partial search. Below is an example of searching by exact match using HUC ID (e.g. `18040009`), and then by region name (\"Upper Tuolumne\").\n\n# Visualize the Response from the HUC Feature Translation Service\n\nBelow are two examples of how to visualize the response from the Feature Translation Service. Here we provide code that takes a response from the HUC Feature Translation Service, and graphs the associated bounding boxes, convex hull polygons, and Visvalingam-Whyatt polygons.\n\n## Function for Visualization\n\nBelow is a function created specifically to visualize the output of the HUC Feature Translation Service. \n\n## Visualization\n\nWe can take that response and pass it to the _visualize()_ function created above. The pink polygon is *Bounding Box*, the green is *Convex Hull Polygon* and the purple color is  *Visvalingam Polygon*\n\nHere we can visualize the *FTS* response using HUC ID search (18040009) instead of Region search of \"Upper Tuolumne\". \n\n## Query CMR by Bounding Box\n\nHere is a more useful example of the Feature Translation Service. We can use results obtained from the FTS to then directly and automatically query on data using CMR. We're extracting the bounding box representing Upper Tuolumne River Basin within the San Joaquin River Basin, and using it to search for granules available from the SMAP/Sentinel-1 missions, as an example. \n\n\n## Query CMR by Polygon\n\nInstead of querying via bounding box from the FTS response, we can extract the polygon of the region and use this to query CMR. Similarly to above, we're extracting information from the Upper Tuolumne River Basin and using this to search for granules available from the Sentinel-1 mission.  \n\nHere we query by _region_ in these two examples, however it would be equally valid to query by _HUC ID_. \n\n## Check with Earthdata Search\n\nHere we show how to check the CMR response with Earth Data Search. First, let's get the number of granules from CMR response. \n\nNote that Earthdata Search query data granules (files) by Visvalingam polygon. So make sure to use Visvalingam polygon when query CMR with polygon\n\nTo find granules in Earth Data Search, we need to first search for the collection. You can search for SMAP/Sentinel to find the Soil Mositure dataset.\n\n![Earthdata_1](Earthdata_1.png)\n\nEarthdata allows you to do an Advanced seach over a HUC region. You can search by HUC ID or HUC region. In our case, let's search for \"HUC Region\" and \"Upper Tuolumne\" .\n\n![Earthdata_2](Earthdata_2.png)\n\n\nFinally, we can locate the total number of granules from the search which matches with the one we identified from CMR.\n\nAlso, our search in Earh Data has a unique url with a project ID. This url corresponds to *SMAP/Sentinel Soil Mositure* granules within the Upper Tuolumne: \n\nhttps://search.earthdata.nasa.gov/search/granules?projectId=3965468611\n\n\n![Earthdata_3](Earthdata_3.png)\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["../include-files.lua","quarto"],"toc":true,"output-file":"HUC Feature Translation Service Examples-updated-20210804.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.1.251","theme":{"light":["cosmo","theme.scss"],"dark":["cosmo","theme-dark.scss"]},"code-copy":true},"extensions":{"book":{"multiFile":true}}}}}