{"title":"Shapefile Search in the Common Metadata Repository (CMR)","markdown":{"headingText":"Shapefile Search in the Common Metadata Repository (CMR)","containsRefs":false,"markdown":"\n\nCMR allows the upload of ESRI Shapefiles via command line for granule and collection level search. To use this functionality from the command line, we can use python or curl to do our search. This example will run through a python request and a curl command line program for doing shapefile search.\n\nPrerequisites:\n\n* a valid ESRI Shapefile\n* (optional) Collection identifier (concept-id) for granule level search \n\nWe will use a shapefile located in the github/podaac source repository for this search: https://github.com/podaac/tutorials/blob/master/notebooks/resources/gulf_shapefile.zip\n\nFor more information on collections, granules, and concept-ids, please refer to the following tutorial:\n\nhttps://github.com/podaac/tutorials/blob/master/notebooks/podaac_cmr_tutorial.ipynb\n\nThis collection is the MODIS_A-JPL-L2P-v2019.0 Level 2 collection from the Moderate Resolution Imaging Spectroradiometer (MODIS) on the NASA Terra satellite. In the CMR environment it has the collection id:\n\nC1940473819-POCLOUD \n\n## Python tutorial shapefile search\n\nThe following snippet will use the 'requests' library along with the shapefile available at github to perform a shapefile search on the CMR. It will return values that overlap or intersect the shapefile provided.\n\n## Curl command line syntax\n\nThis command submits the same request as the Python example above, returning search results in JSON format for Granules that share spatial coverage with the input shapefile ([`resources/gulf_shapefile.zip`](resources/gulf_shapefile.zip)) and belong to the target Collection (`echo_collection_id=C1940473819-POCLOUD`):\n\n```shell\ncurl -XPOST \"https://cmr.earthdata.nasa.gov/search/granules.json\" -F \"shapefile=@resources/gulf_shapefile.zip;type=application/shapefile+zip\" -F \"echo_collection_id=C1940473819-POCLOUD\" -F \"pretty=true\"\n```\n\nThe (truncated) results:\n\n```json\n{\n  \"feed\" : {\n    \"updated\" : \"2020-05-18T22:09:58.452Z\",\n    \"id\" : \"https://cmr.earthdata.nasa.gov:443/search/granules.json\",\n    \"title\" : \"ECHO granule metadata\",\n    \"entry\" : [ {\n      \"time_start\" : \"2002-07-04T06:35:00.000Z\",\n      \"granule_size\" : \"9.34600830078125E5\",\n      \"online_access_flag\" : true,\n      \"id\" : \"G1966128926-POCLOUD\",\n      \"day_night_flag\" : \"UNSPECIFIED\",\n      \"browse_flag\" : true,\n      \"time_end\" : \"2002-07-04T06:39:59.000Z\",\n      \"coordinate_system\" : \"CARTESIAN\",\n      \"polygons\" : [ [ \"-74.21 -163.74 -72.95 -180 -75.43 -180 -74.21 -163.74\" ], [ \"-72.95 180 -69.22 161.56 -63.56 148.24 -59.74 142.63 -54.76 137.29 -43.19 129.21 -28.81 123 -9.39 117.38 70.28 101.89 78.71 98.84 83.8 94.5 85.75 90.5 87.14 84.43 88.59 63.9 89.12 2.26 88.28 -48.29 87.12 -61.14 85.38 -68.1 82.54 -72.63 77.71 -75.93 63.62 -80.05 9.8 -89.82 -15.54 -95.55 -35.84 -102.3 -50.51 -110.4 -56.3 -115.37 -60.99 -120.88 -64.95 -127.37 -68.22 -135.08 -70.76 -143.97 -72.76 -155.11 -74.35 -180 -89.345 -180 -88.32 -113.33 -86.69 -101.61 -83.86 -95.95 -79.32 -92.73 -70.2 -89.86 -10.6 -79.24 16.19 -73.27 33.1 -67.88 46.23 -61.6 52.76 -57.05 57.86 -52.26 62.64 -46.04 66.5 -38.81 69.5 -30.55 71.71 -21.38 74.26 1.26 73.75 29.71 72.1 42.61 69.64 53.42 66.25 62.72 62.36 69.82 57.32 76.19 51.2 81.62 37.2 89.55 18.32 96.04 -10.4 102.56 -70.39 113.28 -79.49 116.19 -83.94 119.43 -86.33 123.83 -87.89 131.86 -86.97 131.68 -85.71 133.93 -81.4 147.95 -77.84 164.04 -75.43 180 -72.95 180\" ], [ \"-74.35 180 -74.81 162.65 -77.45 142.63 -82.89 118.89 -85.78 110.18 -87.46 107.84 -88.13 109.51 -88.85 123.7 -89.345 180 -74.35 180\" ] ],\n      \"original_format\" : \"UMM_JSON\",\n      \"collection_concept_id\" : \"C1940473819-POCLOUD\",\n      \"data_center\" : \"POCLOUD\",\n      \"links\" : [ {\n        \"rel\" : \"http://esipfed.org/ns/fedsearch/1.1/s3#\",\n        \"hreflang\" : \"en-US\",\n        \"href\" : \"s3://podaac-ops-cumulus-protected/MODIS_A-JPL-L2P-v2019.0/20020704063505-JPL-L2P_GHRSST-SSTskin-MODIS_A-N-v02.0-fv01.0.nc\"\n      },\n      ...\n```\n\n\nThis command gets the same listing again with `curl`, this time returning the search results in their native xml format:\n\n```shell\ncurl -XPOST \"https://cmr.earthdata.nasa.gov/search/granules\" -F \"shapefile=@resources/gulf_shapefile.zip;type=application/shapefile+zip\" -F \"echo_collection_id=C1940473819-POCLOUD\" -F \"pretty=true\"\n```\n\nThe (truncated) results:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<results>\n    <hits>1912</hits>\n    <took>970</took>\n    <references>\n        <reference>\n            <name>20020704063505-JPL-L2P_GHRSST-SSTskin-MODIS_A-N-v02.0-fv01.0.nc</name>\n            <id>G1966128926-POCLOUD</id>\n            <location>https://cmr.earthdata.nasa.gov:443/search/concepts/G1226019017-POCUMULUS/1</location>\n            <revision-id>1</revision-id>\n        </reference>\n        ...\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["../include-files.lua","quarto"],"toc":true,"output-file":"PODAAC_CMR_Shapefile_Search_MODIS_UAT.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":{"light":"cosmo","dark":"darkly"},"code-copy":true},"extensions":{"book":{"multiFile":true}}}}}